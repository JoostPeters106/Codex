<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darts Tournament Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<header class="site-header">
    <img src="{{ url_for('static', filename='Dutch_darts_v2.png') }}" alt="Logo">
    <h1>Darts Tournament Manager</h1>
    {% if current_tournament_name %}
    <h2>{{ current_tournament_name }}</h2>
    {% endif %}
    {% if not session.admin_logged_in %}
    <form action="{{ url_for('login') }}" method="post" class="login-form">
        <input type="text" name="username" placeholder="Username" class="styled-input" required>
        <input type="password" name="password" placeholder="Password" class="styled-input" required>
        <button type="submit" class="styled-button secondary-button">Login</button>
    </form>
    {% else %}
    <form action="{{ url_for('logout') }}" method="post" class="login-form">
        <button type="submit" class="styled-button secondary-button">Logout</button>
    </form>
    {% endif %}
</header>

<body>
    <div class="index-layout">
        <section id="new-tournament" class="card">
            <h2>New Tournament</h2>
            {% if session.admin_logged_in %}
            <form action="{{ url_for('set_title') }}" method="post" class="add-player-form">
                <input type="text" class="styled-input" name="tournament_title" placeholder="Tournament title" value="{{ session.tournament_title }}">
                <button type="submit" class="styled-button primary-button">Set Title</button>
            </form>
            <form action="{{ url_for('add_player') }}" method="post" class="add-player-form">
                <input type="text" class="styled-input" name="player_name" placeholder="Player name">
                <button type="submit" class="styled-button primary-button">Add</button>
            </form>

            <div class="player-container">
                {% if players %}
                <ul id="player-list">
                    {% for p in players %}
                    <li>
                        {{ p }}
                        <form action="{{ url_for('remove_player', index=loop.index0) }}" method="post">
                            <button type="submit" class="styled-button danger-button">Remove</button>
                        </form>
                    </li>
                    {% endfor %}
                </ul>
                <form action="{{ url_for('start_tournament') }}" method="post">
                    <button type="submit" class="styled-button primary-button">Start Tournament</button>
                </form>
                {% else %}
                <p>No players added yet.</p>
                {% endif %}
            </div>
            {% else %}
            <p>Login as admin to create tournaments.</p>
            {% endif %}
        </section>

        <section id="past-tournaments" class="card">
            <h2>Past Tournaments</h2>
            {% if tournaments %}
            <ul class="tournament-list">
                {% for t in tournaments %}
                <li>
                    <strong>{{ t.name }}</strong> - {{ t.created_at }}<br>
                    <span class="caption">Players in tournament: {{ t.players|length }}</span>
                    <div class="actions">
                        <a href="{{ url_for('tournament_view', t_id=t.id) }}" class="styled-button secondary-button" style="margin-top: 0px">Open</a>
                        {% if session.admin_logged_in %}
                        <form action="{{ url_for('delete_tournament', t_id=t.id) }}" method="post">
                            <button type="submit" class="styled-button danger-button">Delete</button>
                        </form>
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p>No tournaments saved.</p>
            {% endif %}
        </section>
    </div>

</body>

<footer class="site-footer">
  <div class="footer-left">
    <p>Â© {{ current_year }} Darts Tournament Manager</p>
  </div>
</footer>

</html>
