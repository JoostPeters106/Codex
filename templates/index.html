<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darts Tournament Manager</title>
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap');
    </style>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<header class="site-header">
    <img src="{{ url_for('static', filename='Dutch_darts_v2.png') }}" alt="Logo">
    <h1>Darts Tournament Manager</h1>
    {% if not session.admin_logged_in %}
    <form action="{{ url_for('login') }}" method="post" class="login-form">
        <input type="text" name="username" placeholder="Username" class="styled-input" required>
        <input type="password" name="password" placeholder="Password" class="styled-input" required>
        <button type="submit" class="styled-button secondary-button">Login</button>
    </form>
    {% else %}
    <form action="{{ url_for('logout') }}" method="post" class="login-form">
        <button type="submit" class="styled-button secondary-button">Logout</button>
    </form>
    {% endif %}
</header>

<body style="height: 100%; flex: 1">
    <div class="index-layout">
        <section id="new-tournament" class="card" style="width: 80%;">
            <h2>New Tournament</h2>
            {% if session.admin_logged_in %}
            <form action="{{ url_for('add_player') }}" method="post" class="add-player-form">
                <input type="text" class="styled-input" name="player_name" placeholder="Player name" style="width: 80%">
                <button type="submit" class="styled-button primary-button" style="margin-top: 0.25em;">Add</button>
            </form>

            <div class="player-container">
                {% if players %}
                <ul id="player-list" style="border: 1px solid #000; padding: 10px; list-style-type: none; border-radius: 8px;">
                    {% for p in players %}
                    <li style="border-bottom: 1px solid #ccc; padding: 5px 0;">
                        {{ p }}
                        <form action="{{ url_for('remove_player', index=loop.index0) }}" method="post" style="display:inline; float: right;">
                            <button type="submit" class="styled-button danger-button">Remove</button>
                        </form>
                    </li>
                    {% endfor %}
                </ul>
                <form action="{{ url_for('start_tournament') }}" method="post">
                    <button type="submit" class="styled-button primary-button">Start Tournament</button>
                </form>
                {% else %}
                <p>No players added yet.</p>
                {% endif %}
            </div>
            {% else %}
            <p>Login as admin to create tournaments.</p>
            {% endif %}
        </section>

        <section id="past-tournaments" class="card" style="width: 85%;">
            <h2 style:"text-align: left;">Past Tournaments</h2>
            {% if tournaments %}
            <ul class="tournament-list">
                {% for t in tournaments %}
                <li style="border-bottom: 1px solid #ccc;">
                    <strong>{{ t.name }}</strong> - {{ t.created_at }}<br>
                    <span class="caption">Players in tournament: {{ t.players|length }}</span>
                    <div class="actions">
                        <a href="{{ url_for('tournament_view', t_id=t.id) }}" class="styled-button secondary-button" style="margin-top: 0px">Open</a>
                        {% if session.admin_logged_in %}
                        <form action="{{ url_for('delete_tournament', t_id=t.id) }}" method="post" style="display:inline">
                            <button type="submit" class="styled-button danger-button">Delete</button>
                        </form>
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p>No tournaments saved.</p>
            {% endif %}
        </section>
    </div>

    <section id="group-stage" style="display:none">
        <h2>Group Stage</h2>
        <div id="groups"></div>
        <div id="group-matches"></div>
        <button id="start-knockout" disabled>Start Knockout Phase</button>
    </section>

    <section id="knockout-stage" style="display:none">
        <h2>Knockout Stage</h2>
        <div id="knockout-bracket"></div>
    </section>
</body>

<footer class="site-footer">
  <div class="footer-left">
    <p>Â© {{ current_year }} Darts Tournament Manager</p>
  </div>
</footer>

</html>
